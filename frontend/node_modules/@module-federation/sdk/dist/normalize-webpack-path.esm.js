import path from 'path';

function getWebpackPath(compiler) {
    try {
        // @ts-ignore just throw err
        compiler.webpack();
        return "";
    } catch (err) {
        var _err_stack;
        var trace = ((_err_stack = err.stack) === null || _err_stack === void 0 ? void 0 : _err_stack.split("\n")) || [];
        var webpackErrLocation = trace.find(function(item) {
            return item.includes("at webpack");
        }) || "";
        var webpackLocationWithDetail = webpackErrLocation.replace(/[^\(\)]+/, "").slice(1, -1);
        var webpackPath = webpackLocationWithDetail.split(":").slice(0, -2)[0];
        return require.resolve("webpack", {
            paths: [
                webpackPath
            ]
        });
    }
}
var normalizeWebpackPath = function(fullPath) {
    if (fullPath === "webpack") {
        return process.env["FEDERATION_WEBPACK_PATH"] || fullPath;
    }
    if (process.env["FEDERATION_WEBPACK_PATH"]) {
        return path.resolve(process.env["FEDERATION_WEBPACK_PATH"], fullPath.replace("webpack", "../../"));
    }
    return fullPath;
};

export { getWebpackPath, normalizeWebpackPath };
